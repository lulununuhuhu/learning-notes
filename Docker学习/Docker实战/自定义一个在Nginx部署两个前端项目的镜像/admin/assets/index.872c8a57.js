import{a3 as b,d as ie,r as me,e as R,s as ce,ae as pe,af as _e,N as fe,A as ve,v as C,O as be,o as m,c as y,Q as L,R as ge,x as l,i as e,w as t,k as Fe,z as c,l as he,S as P,J as v,K as x,F as Ce,C as ye,j as f,t as q,m as Ee,T as we,U as V,E as ke,f as De,g as xe,h as Ve,G as Be,H as Se,aU as Ae,Z as Ue,aw as ze,ax as Ne,ay as Ie,Y as Re,aV as Le,ak as Pe,al as qe,am as Me,an as $e,p as Ke,n as Te,q as He}from"./index.96097f3e.js";/* empty css                   *//* empty css                 */import{i as Oe}from"./index.743f1b1d.js";/* empty css                        *//* empty css                 *//* empty css               */function Qe(s){return b({url:"/admin/album/list",method:"get",params:s})}function Ge(s){return b({url:`/admin/album/edit/${s}`,method:"get"})}function je(s){return b({url:"/admin/album/add",method:"post",data:s})}function Je(s){return b({url:"/admin/album/update",method:"put",data:s})}function Ye(s){return b({url:`/admin/album/delete/${s}`,method:"delete"})}const Ze=s=>(Ke("data-v-40b5b683"),s=s(),Te(),s),We={class:"app-container"},Xe=["onClick"],et={class:"album-operation"},tt={class:"photo-count"},at={class:"album-name"},ot={key:1,class:"el-upload__text"},ut=Ze(()=>f("em",null,"\u70B9\u51FB\u4E0A\u4F20",-1)),lt=["src"],nt={class:"dialog-footer"},st=ie({__name:"index",setup(s){const g=me(),M=R({albumName:[{required:!0,message:"\u8BF7\u8F93\u5165\u76F8\u518C\u540D\u79F0",trigger:"blur"}],albumCover:[{required:!0,message:"\u8BF7\u4E0A\u4F20\u76F8\u518C\u5C01\u9762",trigger:"blur"}]}),$=ce(()=>({Authorization:pe+_e()})),K=R({count:0,showSearch:!0,loading:!1,title:"",addOrUpdate:!1,queryParams:{current:1,size:18},albumForm:{},albumList:[]}),{count:B,showSearch:F,loading:E,title:w,addOrUpdate:p,queryParams:i,albumForm:n,albumList:k}=fe(K),T=u=>{Ee.push({path:`/web/photo/${u}`})},H=u=>new Promise(a=>{u.size/1024<200&&a(u),Oe.exports.compressAccurately(u,200).then(d=>{a(d)})}),O=u=>{n.value.albumCover=u.data},Q=u=>{i.value.size=u,_()},G=u=>{i.value.current=u,_()},j=()=>{var u;(u=g.value)==null||u.clearValidate(),w.value="\u65B0\u5EFA\u76F8\u518C",n.value={id:void 0,albumName:"",albumDesc:"",albumCover:"",status:1},p.value=!0},J=u=>{var d;const a=u.substring(0,6);n.value.id=Number(u.substring(6)),a==="delete"?we("\u786E\u8BA4\u5220\u9664\u5DF2\u9009\u4E2D\u7684\u6570\u636E\u9879?").then(()=>{Ye(n.value.id).then(({data:r})=>{r.flag&&(V(r.msg),_())})}).catch(()=>{}):((d=g.value)==null||d.resetFields(),Ge(n.value.id).then(({data:r})=>{r.flag&&(n.value=r.data,w.value="\u4FEE\u6539\u76F8\u518C",p.value=!0)}))},Y=()=>{var u;(u=g.value)==null||u.validate(a=>{a&&(n.value.id!==void 0?Je(n.value).then(({data:d})=>{d.flag&&(V(d.msg),_()),p.value=!1}):je(n.value).then(({data:d})=>{d.flag&&(V(d.msg),_()),p.value=!1}))})},_=()=>{E.value=!0,Qe(i.value).then(({data:u})=>{k.value=u.data.recordList,B.value=u.data.count,E.value=!1})},S=()=>{_()};return ve(()=>{_()}),(u,a)=>{const d=ke,r=De,h=xe,A=Ve,U=Be,Z=C("right-toolbar"),z=Se,W=Ae,X=C("MoreFilled"),D=Ue,N=ze,ee=Ne,te=Ie,ae=Re,oe=C("Hide"),ue=Le,le=C("upload-filled"),ne=Pe,I=qe,se=Me,de=$e,re=be;return m(),y("div",We,[L(e(A,{onSubmit:a[1]||(a[1]=he(()=>{},["prevent"])),inline:!0},{default:t(()=>[e(r,{label:"\u76F8\u518C\u540D\u79F0"},{default:t(()=>[e(d,{modelValue:l(i).keyword,"onUpdate:modelValue":a[0]||(a[0]=o=>l(i).keyword=o),style:{width:"200px"},placeholder:"\u8BF7\u8F93\u5165\u76F8\u518C\u540D\u79F0",clearable:"",onKeyup:Fe(S,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(r,null,{default:t(()=>[e(h,{type:"primary",icon:"Search",onClick:S},{default:t(()=>[c("\u641C\u7D22")]),_:1})]),_:1})]),_:1},512),[[ge,l(F)]]),e(z,{gutter:10,class:"mb15"},{default:t(()=>[e(U,{span:1.5},{default:t(()=>[e(h,{type:"primary",plain:"",icon:"Plus",onClick:j},{default:t(()=>[c("\u65B0\u5EFA")]),_:1})]),_:1}),e(Z,{showSearch:l(F),"onUpdate:showSearch":a[2]||(a[2]=o=>P(F)?F.value=o:null),onQueryTable:_},null,8,["showSearch"])]),_:1}),L((m(),v(z,{gutter:12},{default:t(()=>[l(k)===null?(m(),v(W,{key:0,description:"\u6682\u65E0\u76F8\u518C"})):x("",!0),(m(!0),y(Ce,null,ye(l(k),o=>(m(),v(U,{key:o.id,xs:12,sm:12,lg:6},{default:t(()=>[f("div",{class:"album-item",onClick:dt=>T(o.id)},[f("div",et,[e(te,{onCommand:J},{dropdown:t(()=>[e(ee,null,{default:t(()=>[e(N,{command:"update"+o.id},{default:t(()=>[c("\u7F16\u8F91")]),_:2},1032,["command"]),e(N,{command:"delete"+o.id},{default:t(()=>[c("\u5220\u9664")]),_:2},1032,["command"])]),_:2},1024)]),default:t(()=>[e(D,{style:{color:"#fff"}},{default:t(()=>[e(X)]),_:1})]),_:2},1024)]),e(ae,{class:"album-cover",fit:"cover",src:o.albumCover},null,8,["src"]),f("div",tt,[f("div",null,q(o.photoCount),1),o.status===2?(m(),v(D,{key:0},{default:t(()=>[e(oe)]),_:1})):x("",!0)]),f("div",at,q(o.albumName),1)],8,Xe)]),_:2},1024))),128))]),_:1})),[[re,l(E)]]),e(ue,{class:"pagination-container","current-page":l(i).current,"onUpdate:currentPage":a[3]||(a[3]=o=>l(i).current=o),"page-size":l(i).size,"onUpdate:pageSize":a[4]||(a[4]=o=>l(i).size=o),"hide-on-single-page":!0,layout:" prev, pager, next",total:l(B),onSizeChange:Q,onCurrentChange:G},null,8,["current-page","page-size","total"]),e(de,{title:l(w),modelValue:l(p),"onUpdate:modelValue":a[9]||(a[9]=o=>P(p)?p.value=o:null),width:"550px","append-to-body":""},{footer:t(()=>[f("div",nt,[e(h,{type:"primary",onClick:Y},{default:t(()=>[c("\u786E \u5B9A")]),_:1}),e(h,{onClick:a[8]||(a[8]=o=>p.value=!1)},{default:t(()=>[c("\u53D6 \u6D88")]),_:1})])]),default:t(()=>[e(A,{ref_key:"albumFormRef",ref:g,"label-width":"100px",model:l(n),rules:M},{default:t(()=>[e(r,{label:"\u76F8\u518C\u540D\u79F0",prop:"albumName"},{default:t(()=>[e(d,{placeholder:"\u8BF7\u8F93\u5165\u76F8\u518C\u540D\u79F0",modelValue:l(n).albumName,"onUpdate:modelValue":a[5]||(a[5]=o=>l(n).albumName=o),style:{width:"250px"}},null,8,["modelValue"])]),_:1}),e(r,{label:"\u76F8\u518C\u63CF\u8FF0",prop:"albumDesc"},{default:t(()=>[e(d,{placeholder:"\u8BF7\u8F93\u5165\u76F8\u518C\u63CF\u8FF0",modelValue:l(n).albumDesc,"onUpdate:modelValue":a[6]||(a[6]=o=>l(n).albumDesc=o),style:{width:"250px"}},null,8,["modelValue"])]),_:1}),e(r,{label:"\u76F8\u518C\u5C01\u9762",prop:"albumCover"},{default:t(()=>[e(ne,{drag:"","show-file-list":!1,headers:$.value,action:"/api/admin/album/upload",accept:"image/*","before-upload":H,"on-success":O},{default:t(()=>[l(n).albumCover===""?(m(),v(D,{key:0,class:"el-icon--upload"},{default:t(()=>[e(le)]),_:1})):x("",!0),l(n).albumCover===""?(m(),y("div",ot,[c(" \u5C06\u6587\u4EF6\u62D6\u5230\u6B64\u5904\uFF0C\u6216"),ut])):(m(),y("img",{key:2,src:l(n).albumCover,width:"360"},null,8,lt))]),_:1},8,["headers"])]),_:1}),e(r,{label:"\u53D1\u5E03\u5F62\u5F0F"},{default:t(()=>[e(se,{modelValue:l(n).status,"onUpdate:modelValue":a[7]||(a[7]=o=>l(n).status=o)},{default:t(()=>[e(I,{label:1},{default:t(()=>[c("\u516C\u5F00")]),_:1}),e(I,{label:2},{default:t(()=>[c("\u79C1\u5BC6")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});const vt=He(st,[["__scopeId","data-v-40b5b683"]]);export{vt as default};
