import{a3 as b,d as tt,r as M,e as et,N as st,a6 as yt,o as d,c as v,x as n,aY as Bt,q as at,s as O,ae as Dt,af as bt,A as Tt,v as A,i as t,w as s,z as _,P as J,J as S,K as V,F as q,C as R,j as h,t as U,Q as Lt,R as zt,S as At,T as St,U as K,g as Vt,G as qt,H as Rt,aU as Ut,Z as Mt,aw as Pt,ax as It,ay as Ht,_ as $t,Y as Nt,aV as Ot,f as Jt,h as Kt,aj as Yt,ak as Gt,a0 as Qt,an as Zt}from"./index.96097f3e.js";import{i as Wt}from"./index.743f1b1d.js";/* empty css                   *//* empty css                        *//* empty css                 *//* empty css               */import{a as Xt}from"./date.f8742d84.js";function te(c){return b({url:"/admin/talk/list",method:"get",params:c})}function ee(c){return b({url:`/admin/talk/edit/${c}`,method:"get"})}function se(c){return b({url:"/admin/talk/add",method:"post",data:c})}function ae(c){return b({url:"/admin/talk/update",method:"put",data:c})}function oe(c){return b({url:`/admin/talk/delete/${c}`,method:"delete"})}const ne=["innerHTML","placeholder"],ue=tt({__name:"index",props:{text:{type:String,default:""},placeholder:{type:String,default:""}},emits:["update:text"],setup(c,{expose:x,emit:y}){const j=c,{proxy:C}=Bt(),B=M(),P=et({content:j.text,focusIn:!1,range:null}),{content:D,focusIn:w,range:m}=st(P);yt(()=>j.text,l=>{w.value||(D.value=l)});const k=l=>{y("update:text",l.target.innerHTML)},g=()=>{w.value=!0},T=()=>{if(window.getSelection){let l=window.getSelection();m.value=l.getRangeAt(0)}w.value=!1};return x({addText:l=>{if(window.getSelection){let i=window.getSelection();i.removeAllRanges(),m.value==null&&(B.value.focus(),m.value=i.getRangeAt(0)),m.value.deleteContents(),m.value.insertNode(m.value.createContextualFragment(l)),m.value.collapse(!1),i.addRange(m.value),y("update:text",C.$el.innerHTML)}},clear:()=>{D.value="",C.$el.innerHTML=""}}),(l,i)=>(d(),v("div",{ref_key:"editorRef",ref:B,class:"edit-container",innerHTML:n(D),contenteditable:"",placeholder:c.placeholder,onFocus:g,onBlur:T,onInput:k},null,40,ne))}});const ie=at(ue,[["__scopeId","data-v-2e9475e8"]]),le={"[\u70ED]":"https://static.ttkwsd.top/emoji/re.png","[\u51B7]":"https://static.ttkwsd.top/emoji/leng.png","[\u8131\u5355doge]":"https://static.ttkwsd.top/emoji/doge.png","[\u5FAE\u7B11]":"https://static.ttkwsd.top/emoji/simle.png","[\u7B11]":"https://static.ttkwsd.top/emoji/xiao.png","[\u5446]":"https://static.ttkwsd.top/emoji/dai.png","[\u7075\u9B42\u51FA\u7A8D]":"https://static.ttkwsd.top/emoji/lhcq.png","[\u661F\u661F\u773C]":"https://static.ttkwsd.top/emoji/xxy.png","[\u8138\u7EA2]":"https://static.ttkwsd.top/emoji/lianhong.png","[\u5077\u7B11]":"https://static.ttkwsd.top/emoji/touxiao.png","[\u5410]":"https://static.ttkwsd.top/emoji/tu.png","[\u60CA\u559C]":"https://static.ttkwsd.top/emoji/jingxi.png","[\u56E7]":"https://static.ttkwsd.top/emoji/jiong.png","[\u62A0\u9F3B]":"https://static.ttkwsd.top/emoji/koubi.png","[\u54C8\u6B20]":"https://static.ttkwsd.top/emoji/hqian.png","[\u5927\u54ED]":"https://static.ttkwsd.top/emoji/daku.png","[\u8FA3\u773C\u775B]":"https://static.ttkwsd.top/emoji/lyj.png","[\u5403\u74DC]":"https://static.ttkwsd.top/emoji/chigua.png","[\u6ED1\u7A3D]":"https://static.ttkwsd.top/emoji/guaji.png","[\u5472\u7259]":"https://static.ttkwsd.top/emoji/ciya.png","[\u6253call]":"https://static.ttkwsd.top/emoji/dacall.png","[\u50B2\u5A07]":"https://static.ttkwsd.top/emoji/aojiao.png","[\u561F\u561F]":"https://static.ttkwsd.top/emoji/dudu.png","[\u7FFB\u767D\u773C]":"https://static.ttkwsd.top/emoji/fanby.png","[\u5C34\u5C2C]":"https://static.ttkwsd.top/emoji/ganga.png","[\u7ED9\u5FC3\u5FC3]":"https://static.ttkwsd.top/emoji/geixx.png","[\u55D1\u74DC\u5B50]":"https://static.ttkwsd.top/emoji/kgz.png","[\u7B11\u54ED]":"https://static.ttkwsd.top/emoji/xiaoku.png","[\u5927\u7B11]":"https://static.ttkwsd.top/emoji/daxiao.png","[\u559C\u6B22]":"https://static.ttkwsd.top/emoji/xihuan.png","[\u7591\u60D1]":"https://static.ttkwsd.top/emoji/yihuo.png","[\u751F\u6C14]":"https://static.ttkwsd.top/emoji/shengqi.png","[\u9634\u9669]":"https://static.ttkwsd.top/emoji/yinxian.png","[doge]":"https://static.ttkwsd.top/emoji/doge.png","[\u70B9\u8D5E]":"https://static.ttkwsd.top/emoji/dianzan.png","[\u96BE\u8FC7]":"https://static.ttkwsd.top/emoji/nanguo.png","[\u5618\u58F0]":"https://static.ttkwsd.top/emoji/xusheng.png","[\u60CA\u8BB6]":"https://static.ttkwsd.top/emoji/jingya.png","[\u559C\u6781\u800C\u6CE3]":"https://static.ttkwsd.top/emoji/xjeq.png","[\u601D\u8003]":"https://static.ttkwsd.top/emoji/sikao.png","[\u9F13\u638C]":"https://static.ttkwsd.top/emoji/guzhang.png","[\u9178\u4E86]":"https://static.ttkwsd.top/emoji/suanle.png","[\u59D4\u5C48]":"https://static.ttkwsd.top/emoji/weiqu.png","[\u6342\u8138]":"https://static.ttkwsd.top/emoji/wulian.png","[\u6342\u773C]":"https://static.ttkwsd.top/emoji/wuyan.png","[\u54E6\u547C]":"https://static.ttkwsd.top/emoji/ohu.png","[\u65E0\u8BED]":"https://static.ttkwsd.top/emoji/wuyu.png","[\u5413]":"https://static.ttkwsd.top/emoji/xia.png","[\u75BC]":"https://static.ttkwsd.top/emoji/teng.png","[\u6B6A\u5634]":"https://static.ttkwsd.top/emoji/waizui.png","[\u6293\u72C2]":"https://static.ttkwsd.top/emoji/zhuakuang.png","[\u751F\u75C5]":"https://static.ttkwsd.top/emoji/shengbing.png","[\u8C03\u76AE]":"https://static.ttkwsd.top/emoji/tiaopi.png","[\u5999\u554A]":"https://static.ttkwsd.top/emoji/miaoa.png","[\u6487\u5634]":"https://static.ttkwsd.top/emoji/piezui.png","[\u518D\u89C1]":"https://static.ttkwsd.top/emoji/zaijian.png","[\u5ACC\u5F03]":"https://static.ttkwsd.top/emoji/xianqi.png","[\u594B\u6597]":"https://static.ttkwsd.top/emoji/fendou.png","[\u58A8\u955C]":"https://static.ttkwsd.top/emoji/mojing.png","[OK]":"https://static.ttkwsd.top/emoji/ok.png","[\u5E72\u676F]":"https://static.ttkwsd.top/emoji/ganbei.png","[\u7231\u5FC3]":"https://static.ttkwsd.top/emoji/aixin.png","[\u652F\u6301]":"https://static.ttkwsd.top/emoji/zhichi.png","[\u62B1\u62F3]":"https://static.ttkwsd.top/emoji/baoquan.png","[\u4FDD\u4F51]":"https://static.ttkwsd.top/emoji/baoyou.png","[\u80DC\u5229]":"https://static.ttkwsd.top/emoji/shengli.png","[\u52A0\u6CB9]":"https://static.ttkwsd.top/emoji/jiayou.png","[\u62E5\u62B1]":"https://static.ttkwsd.top/emoji/yongbao.png","[\u539F\u795E_\u6B38\u563F]":"https://static.ttkwsd.top/emoji/aihei.png","[\u539F\u795E_\u54C7]":"https://static.ttkwsd.top/emoji/wa.png","[\u539F\u795E_\u55EF]":"https://static.ttkwsd.top/emoji/en.png","[\u539F\u795E_\u54FC]":"https://static.ttkwsd.top/emoji/heng.png","[\u539F\u795E_\u559D\u8336]":"https://static.ttkwsd.top/emoji/hecha.png","[\u539F\u795E_\u751F\u6C14]":"https://static.ttkwsd.top/emoji/kqsq.png","[tv_\u5FAE\u7B11]":"https://static.ttkwsd.top/emoji/tvwx.png","[tv_\u659C\u773C\u7B11]":"https://static.ttkwsd.top/emoji/tvxyx.png"},pe={class:"app-container"},de=["src"],ce={class:"talk-content-container"},re={class:"user-info"},me={class:"user-name"},ge={class:"talk-info"},_e={class:"talk-time"},he={key:0,class:"top"},ke={key:1,class:"secret"},ve=["innerHTML"],we=["onClick"],fe=["src","title"],je={class:"el-dropdown-link"},Ce=["src"],Ee=tt({__name:"index",setup(c){const x=M(),y=M(""),j=M(!1),C=O(()=>function(e){return g.value.status==e?"active-status":"status"}),B=O(()=>({Authorization:Dt+bt()})),P=O(()=>{let e="\u516C\u5F00";return T.value.forEach(a=>{a.value==u.value.status&&(e=a.label)}),e}),D=et({count:0,title:"",addOrUpdate:!1,queryParams:{current:1,size:5,status:void 0},statusList:[{value:1,label:"\u516C\u5F00"},{value:2,label:"\u79C1\u5BC6"}],previewList:[],talkForm:{id:void 0,talkContent:"",images:"",isTop:0,status:1},talkList:[],uploadList:[]}),{count:w,title:m,addOrUpdate:k,queryParams:g,statusList:T,previewList:E,talkForm:u,talkList:l,uploadList:i}=st(D),Y=e=>{i.value.push({url:e.data})},ot=e=>{i.value.forEach((a,p)=>{a.url==e.url&&i.value.splice(p,1)})},nt=e=>{y.value=e.url,j.value=!0},G=e=>new Promise(a=>{e.size/1024<200&&a(e),Wt.exports.compressAccurately(e,200).then(p=>{a(p)})}),ut=e=>{const a=e.substring(0,6);u.value.id=Number(e.substring(6)),a==="delete"?St("\u786E\u8BA4\u5220\u9664\u5DF2\u9009\u4E2D\u7684\u6570\u636E\u9879?").then(()=>{oe(u.value.id).then(({data:p})=>{p.flag&&(K(p.msg),f())})}).catch(()=>{}):ee(u.value.id).then(({data:p})=>{p.flag&&(u.value=p.data,p.data.imgList&&p.data.imgList.forEach(r=>{i.value.push({url:r})}),m.value="\u4FEE\u6539\u8BF4\u8BF4",k.value=!0)})},it=e=>{u.value.status=e},lt=(e,a)=>{x.value.addText("<img src= '"+a+"' width='24'height='24' alt="+e+" style='margin: 0 1px;vertical-align: text-bottom'/>")},I=e=>{g.value.current=1,E.value=[],g.value.status=e,f()},pt=e=>{E.value=[],g.value.size=e,f()},dt=e=>{E.value=[],g.value.current=e,f()},ct=()=>{if(i.value.length>0){let e=[];i.value.forEach(a=>{e.push(a.url)}),u.value.images=JSON.stringify(e)}else u.value.images="";u.value.id!==void 0?ae(u.value).then(({data:e})=>{e.flag&&(i.value=[],K(e.msg),f()),k.value=!1}):se(u.value).then(({data:e})=>{e.flag&&(K(e.msg),f()),k.value=!1})},rt=()=>{u.value={id:void 0,talkContent:"",images:"",isTop:0,status:1},i.value=[],x.value.clear()},mt=()=>{rt(),k.value=!1},gt=()=>{u.value={id:void 0,talkContent:"",images:"",isTop:0,status:1},m.value="\u53D1\u5E03\u8BF4\u8BF4",k.value=!0},f=()=>{te(g.value).then(({data:e})=>{l.value=e.data.recordList,l.value&&l.value.forEach(a=>{a.imgList&&E.value.push(...a.imgList)}),w.value=e.data.count})};return Tt(()=>{f()}),(e,a)=>{const p=Vt,r=qt,L=Rt,_t=Ut,ht=A("MoreFilled"),z=Mt,H=Pt,Q=It,Z=Ht,$=$t,kt=A("Hide"),vt=Nt,wt=Ot,ft=Jt,jt=Kt,Ct=Yt,W=Gt,Et=Qt,Ft=A("arrow-down"),xt=A("Plus"),X=Zt;return d(),v("div",pe,[t(L,{gutter:10,class:"mb15"},{default:s(()=>[t(r,{span:1.5},{default:s(()=>[t(p,{type:"primary",plain:"",icon:"Promotion",onClick:gt},{default:s(()=>[_("\u53D1\u5E03\u8BF4\u8BF4")]),_:1})]),_:1})]),_:1}),t(L,{gutter:24,style:{color:"#999"}},{default:s(()=>[t(r,{span:1.5},{default:s(()=>[_(" \u72B6\u6001 ")]),_:1}),t(r,{span:1.5,class:J(C.value(void 0)),onClick:a[0]||(a[0]=o=>I(void 0))},{default:s(()=>[_(" \u5168\u90E8 ")]),_:1},8,["class"]),t(r,{span:1.5,class:J(C.value(1)),onClick:a[1]||(a[1]=o=>I(1))},{default:s(()=>[_(" \u516C\u5F00 ")]),_:1},8,["class"]),t(r,{span:1.5,class:J(C.value(2)),onClick:a[2]||(a[2]=o=>I(2))},{default:s(()=>[_(" \u79C1\u5BC6 ")]),_:1},8,["class"])]),_:1}),n(l)===null?(d(),S(_t,{key:0,description:"\u6682\u65E0\u8BF4\u8BF4"})):V("",!0),(d(!0),v(q,null,R(n(l),o=>(d(),v("div",{class:"talk-item",key:o.id},[h("img",{class:"user-avatar",src:o.avatar},null,8,de),h("div",ce,[h("div",re,[h("div",me,U(o.nickname),1),t(Z,{trigger:"click",onCommand:ut},{dropdown:s(()=>[t(Q,null,{default:s(()=>[t(H,{command:"update"+o.id},{default:s(()=>[_("\u7F16\u8F91")]),_:2},1032,["command"]),t(H,{command:"delete"+o.id},{default:s(()=>[_("\u5220\u9664")]),_:2},1032,["command"])]),_:2},1024)]),default:s(()=>[t(z,{style:{color:"#333"}},{default:s(()=>[t(ht)]),_:1})]),_:2},1024)]),h("div",ge,[h("span",_e,U(n(Xt)(o.createTime)),1),o.isTop===1?(d(),v("span",he,[t($,{"icon-class":"top",size:"0.85rem"}),_("\u7F6E\u9876")])):V("",!0),o.status===2?(d(),v("span",ke,[t(z,null,{default:s(()=>[t(kt)]),_:1}),_(" \u79C1\u5BC6")])):V("",!0)]),h("div",{class:"talk-content",innerHTML:o.talkContent},null,8,ve),t(L,{gutter:4,style:{"margin-top":"0.5rem"}},{default:s(()=>[(d(!0),v(q,null,R(o.imgList,(F,N)=>(d(),S(r,{md:8,cols:6,key:N},{default:s(()=>[t(vt,{class:"talk-image",src:F,"preview-src-list":n(E)},null,8,["src","preview-src-list"])]),_:2},1024))),128))]),_:2},1024)])]))),128)),n(w)>0?(d(),S(wt,{key:1,class:"pagination-container","current-page":n(g).current,"onUpdate:currentPage":a[3]||(a[3]=o=>n(g).current=o),"page-size":n(g).size,"onUpdate:pageSize":a[4]||(a[4]=o=>n(g).size=o),layout:"prev, pager, next",total:n(w),onSizeChange:pt,onCurrentChange:dt},null,8,["current-page","page-size","total"])):V("",!0),t(X,{title:n(m),modelValue:n(k),"onUpdate:modelValue":a[7]||(a[7]=o=>At(k)?k.value=o:null),onClose:mt,width:"750px","append-to-body":""},{default:s(()=>[t(jt,{model:n(u)},{default:s(()=>[t(ft,{prop:"talkContent"},{default:s(()=>[t(ie,{ref_key:"editorRef",ref:x,text:n(u).talkContent,"onUpdate:text":a[5]||(a[5]=o=>n(u).talkContent=o),placeholder:"\u8BF4\u70B9\u4EC0\u4E48\u5427"},null,8,["text"])]),_:1})]),_:1},8,["model"]),t(L,{gutter:10,align:"middle",style:{"margin-top":"16px"}},{default:s(()=>[t(r,{span:1.5},{default:s(()=>[t(Ct,{placement:"bottom-start",width:460,trigger:"click"},{reference:s(()=>[h("span",null,[t($,{"icon-class":"emoji",size:"1.4rem",color:"#838383"})])]),default:s(()=>[(d(!0),v(q,null,R(n(le),(o,F,N)=>(d(),v("span",{class:"emoji-item",key:N,onClick:Fe=>lt(F,o)},[h("img",{src:o,title:F,class:"emoji",width:"24",height:"24"},null,8,fe)],8,we))),128))]),_:1})]),_:1}),t(r,{span:1.5},{default:s(()=>[t(W,{accept:"image/*",multiple:"",action:"/api/admin/talk/upload",headers:B.value,"before-upload":G,"on-success":Y,"show-file-list":!1},{default:s(()=>[t($,{"icon-class":"album",size:"1.5rem",color:"#838383",style:{"padding-top":"0.1rem"}})]),_:1},8,["headers"])]),_:1}),t(r,{span:1.5,offset:14},{default:s(()=>[t(Et,{style:{"margin-right":"7px"},modelValue:n(u).isTop,"onUpdate:modelValue":a[6]||(a[6]=o=>n(u).isTop=o),"inactive-text":"\u7F6E\u9876","active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),t(r,{span:1.5},{default:s(()=>[t(Z,{trigger:"click",onCommand:it},{dropdown:s(()=>[t(Q,null,{default:s(()=>[(d(!0),v(q,null,R(n(T),(o,F)=>(d(),S(H,{key:F,command:o.value},{default:s(()=>[_(U(o.label),1)]),_:2},1032,["command"]))),128))]),_:1})]),default:s(()=>[h("span",je,[_(U(P.value)+" ",1),t(z,{class:"el-icon--right"},{default:s(()=>[t(Ft)]),_:1})])]),_:1})]),_:1}),t(r,{span:1.5},{default:s(()=>[t(p,{type:"primary",disabled:n(u).talkContent==="",onClick:ct},{default:s(()=>[_("\u53D1\u5E03")]),_:1},8,["disabled"])]),_:1})]),_:1}),Lt(t(W,{accept:"image/*",action:"/api/admin/talk/upload",headers:B.value,"list-type":"picture-card","file-list":n(i),multiple:"","before-upload":G,"on-success":Y,"on-remove":ot,"on-preview":nt,style:{"margin-top":"1rem"}},{default:s(()=>[t(z,null,{default:s(()=>[t(xt)]),_:1})]),_:1},8,["headers","file-list"]),[[zt,n(i).length>0]])]),_:1},8,["title","modelValue"]),t(X,{modelValue:j.value,"onUpdate:modelValue":a[8]||(a[8]=o=>j.value=o),"append-to-body":""},{default:s(()=>[h("img",{src:y.value,style:{"max-width":"100%"}},null,8,Ce)]),_:1},8,["modelValue"])])}}});const ze=at(Ee,[["__scopeId","data-v-d2aa8262"]]);export{ze as default};
